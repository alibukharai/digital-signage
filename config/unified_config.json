{
    "_comment": "Unified Configuration for Rock Pi 3399 Provisioning System",
    "_usage": "Copy this file to /etc/rock-provisioning/config.json or ~/.config/rock-provisioning/config.json",
    "version": "2.0",
    "last_updated": "2025-07-15T00:00:00Z",
    "ble": {
        "service_uuid": "12345678-1234-5678-9abc-123456789abc",
        "wifi_credentials_char_uuid": "12345678-1234-5678-9abc-123456789abd",
        "status_char_uuid": "12345678-1234-5678-9abc-123456789abe",
        "device_info_char_uuid": "12345678-1234-5678-9abc-123456789abf",
        "advertising_timeout": 300,
        "connection_timeout": 30,
        "max_connections": 1,
        "advertising_name": "RockPi-Setup",
        "security": {
            "connection_rate_limit": 10,
            "block_duration_hours": 1,
            "payload_validation": true,
            "suspicious_pattern_detection": true,
            "client_authentication_required": true,
            "payload_size_limit": 512
        }
    },
    "security": {
        "encryption_algorithm": "Fernet",
        "key_derivation_iterations": 600000,
        "credential_timeout": 300,
        "require_owner_setup": true,
        "owner_setup_timeout": 600,
        "owner_pin_length": 6,
        "max_owner_setup_attempts": 3,
        "owner_lockout_duration": 3600,
        "enforce_https_only": true,
        "session_token_rotation": true,
        "enable_audit_logging": true,
        "max_concurrent_sessions": 5,
        "enhanced_security": true,
        "use_hardware_security": true,
        "strict_validation": true,
        "rate_limiting_enabled": true,
        "cryptography": {
            "master_key_lifetime_days": 30,
            "session_key_lifetime_minutes": 15,
            "device_key_lifetime_days": 90,
            "pbkdf2_iterations_master": 600000,
            "pbkdf2_iterations_session": 200000,
            "use_hardware_rng": true,
            "secure_memory_wiping": true,
            "key_rotation_automation": true,
            "min_key_size_bits": 256,
            "require_hardware_rng": true,
            "max_key_age_days": 30,
            "quantum_resistant_algorithms": true,
            "secure_key_storage": true
        },
        "authentication": {
            "max_failed_attempts": 3,
            "lockout_duration_seconds": 3600,
            "session_timeout_minutes": 15,
            "owner_pin_complexity_required": true,
            "exponential_backoff": true
        },
        "input_validation": {
            "strict_mode": true,
            "password_min_length": 12,
            "password_require_complexity": true,
            "password_min_entropy": 3.5,
            "ssid_security_validation": true,
            "sanitize_logs": true
        },
        "session_management": {
            "max_sessions_per_client": 2,
            "suspicious_activity_threshold": 5,
            "rate_limit_window_seconds": 30,
            "token_rotation_enabled": true,
            "secure_session_storage": true,
            "max_lifetime_minutes": 15,
            "require_rotation": true,
            "idle_timeout_minutes": 5,
            "secure_transport_only": true
        },
        "policies": {
            "password_policy": {
                "min_length": 12,
                "require_uppercase": true,
                "require_lowercase": true,
                "require_digits": true,
                "require_special_chars": true,
                "forbidden_patterns": [
                    "password", "123456", "qwerty", "admin", "root", "guest", "test"
                ],
                "max_age_days": 90,
                "prevent_reuse": true
            },
            "pin_policy": {
                "min_length": 6,
                "max_length": 12,
                "forbidden_patterns": [
                    "1234", "0000", "1111", "2222", "3333", "4444",
                    "5555", "6666", "7777", "8888", "9999"
                ],
                "prevent_sequences": true,
                "prevent_keyboard_patterns": true,
                "prevent_date_patterns": true
            },
            "network_policy": {
                "require_wpa3": false,
                "minimum_wpa2": true,
                "block_open_networks": false,
                "validate_certificates": true,
                "secure_protocols_only": true,
                "ssid_security_validation": true,
                "insecure_network_warnings": true,
                "configuration_encryption": true,
                "backup_encryption": true
            }
        },
        "audit_logging": {
            "enabled": true,
            "integrity_hashing": true,
            "sensitive_data_sanitization": true,
            "max_events": 10000,
            "retention_days": 365,
            "real_time_monitoring": true,
            "anomaly_detection": true,
            "log_all_authentication": true,
            "log_all_authorization": true,
            "log_all_data_access": true,
            "log_configuration_changes": true,
            "require_integrity_hashes": true,
            "real_time_alerting": true
        },
        "compliance": {
            "enforce_security_policies": true,
            "regular_compliance_checks": true,
            "violation_reporting": true,
            "security_score_monitoring": true
        },
        "factory_reset": {
            "rate_limiting": true,
            "max_attempts_per_hour": 3,
            "audit_logging": true,
            "secure_data_wiping": true,
            "authentication_required": true
        },
        "monitoring": {
            "security_metrics_tracking": true,
            "trend_analysis": true,
            "alerting_enabled": true,
            "dashboard_integration": true
        },
        "thresholds": {
            "authentication_failure_rate": 0.3,
            "security_violation_limit": 10,
            "key_rotation_days": 30,
            "session_anomaly_threshold": 5,
            "ble_connection_rate": 10,
            "minimum_security_score": 70
        },
        "emergency_procedures": {
            "auto_lockdown_enabled": true,
            "lockdown_triggers": [
                "excessive_failed_logins",
                "security_violations",
                "anomaly_detection"
            ],
            "emergency_contacts": [],
            "incident_response_automation": true
        },
        "hardware_security": {
            "use_tpm_if_available": true,
            "use_secure_enclave": true,
            "hardware_entropy": true,
            "secure_boot_validation": false,
            "memory_protection": true
        }
    },
    "display": {
        "resolution_width": 1920,
        "resolution_height": 1080,
        "qr_size_ratio": 0.3,
        "fullscreen": true,
        "font_path": "/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf",
        "refresh_interval": 30,
        "show_status": true,
        "status_position": "bottom",
        "background_color": "#000000",
        "text_color": "#FFFFFF"
    },
    "network": {
        "config_file_primary": "/etc/wifi_config.json",
        "config_file_fallback": "~/.wifi_config.json",
        "connection_timeout": 30,
        "scan_timeout": 10,
        "max_retry_attempts": 3,
        "interface_name": "wlan0",
        "enable_ethernet_fallback": true,
        "ethernet_interface": "eth0"
    },
    "logging": {
        "level": "INFO",
        "file_path": "/var/log/rock-provisioning.log",
        "max_file_size": 10485760,
        "backup_count": 5,
        "console_output": true,
        "log_rotation": true,
        "detailed_logs": true,
        "performance_logging": true,
        "security_logging": true
    },
    "system": {
        "auto_start": true,
        "check_network_on_boot": true,
        "provision_on_no_network": true,
        "health_check_interval": 30,
        "performance_monitoring": true,
        "security_monitoring": true,
        "max_provision_time": 600,
        "restart_on_failure": true,
        "factory_reset_gpio_pin": 18,
        "factory_reset_hold_time": 5,
        "factory_reset_enabled": true,
        "company_recovery_enabled": true,
        "company_api_url": "https://api.company.com/device-recovery"
    }
}
